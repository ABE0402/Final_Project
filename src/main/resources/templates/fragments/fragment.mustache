<!-- templates/fragments/fragment.mustache -->
{{#sections}}
    <section class="tag-section mb-5" data-tag="{{tag}}">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center mb-2">
                <h5 class="m-0">{{title}}</h5>

                <!-- 정렬 드롭다운(버튼 + 옵션) : main.js가 제어 -->
                <div class="position-relative">
                    <button type="button" class="btn btn-sm btn-outline-secondary sort-btn">
                        {{sortLabel}} ▼
                    </button>
                    <ul class="sort-options list-unstyled shadow-sm p-2 bg-white rounded-3"
                        style="position:absolute; right:0; top:100%; min-width:140px; display:none;">
                        <li class="px-2 py-1 {{#sortSelected.recommend}}selected{{/sortSelected.recommend}}" data-sort="recommend">추천순</li>
                        <li class="px-2 py-1 {{#sortSelected.rating}}selected{{/sortSelected.rating}}" data-sort="rating">평점순</li>
                        <li class="px-2 py-1 {{#sortSelected.review}}selected{{/sortSelected.review}}" data-sort="review">리뷰순</li>
                        <li class="px-2 py-1 {{#sortSelected.favorite}}selected{{/sortSelected.favorite}}" data-sort="favorite">즐겨찾기순</li>
                    </ul>
                </div>
            </div>

            <!-- 캐러셀 (좌/우 버튼 + 가로 스크롤 컨테이너) -->
            <div class="position-relative">
                <button class="carousel-btn prev btn btn-light border position-absolute top-50 start-0 translate-middle-y">‹</button>
                <div class="overflow-hidden px-4">
                    <div class="d-flex gap-3 carousel-items" style="transition:transform .25s;">
                        {{#items}}
                            <a class="card text-decoration-none text-reset" style="width:220px"
                               href="/{{pathSegment}}/{{id}}">
                                <div class="ratio ratio-16x9 bg-light card-img-top"
                                     style="background-image:url('{{#heroImageUrl}}{{.}}{{/heroImageUrl}}{{^heroImageUrl}}/images/placeholder.jpg{{/heroImageUrl}}'); background-size:cover; background-position:center; border-top-left-radius:.5rem; border-top-right-radius:.5rem;">
                                </div>
                                <div class="card-body p-2">
                                    <div class="d-flex justify-content-between align-items-start">
                                        <h6 class="card-title text-truncate m-0">{{name}}</h6>
                                        <span class="badge text-bg-success">{{type}}</span>
                                    </div>
                                    <div class="small text-muted text-truncate">{{address}}</div>
                                    <div class="mt-1 small">⭐ {{averageRating}} · 리뷰 {{reviewCount}}</div>
                                </div>
                            </a>
                        {{/items}}

                        {{^items}}
                            <div class="alert alert-light border empty-message m-0 w-100 text-center">
                                표시할 매장이 없습니다.
                            </div>
                        {{/items}}
                    </div>
                </div>
                <button class="carousel-btn next btn btn-light border position-absolute top-50 end-0 translate-middle-y">›</button>
            </div>
        </div>
    </section>
{{/sections}}

<div id="has-more" data-value="{{hasMore}}"></div>
